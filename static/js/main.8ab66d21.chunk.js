(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return s});var o=n(4),r=n(19),a=!1;if(o.b.USE_ELECTRON){var i=window.require("electron");a=i.ipcRenderer}var c=function(){var e=o.b.USE_PHOTODIODE?"visible":"invisible";return'<div class="photodiode-box '.concat(e,'" id="photodiode-box">\n\t\t\t\t\t\t\t\t\t<span id="photodiode-spot" class="photodiode-spot"></span>\n  \t\t\t\t\t\t\t\t</div>')},s=function(e){if(o.b.USE_PHOTODIODE){var t=e;e<r.eventCodes.open_task&&(t=1),function e(t,n){n>0&&function(e,t){document.getElementById("photodiode-spot").setAttribute("style","background-color: white"),setTimeout(function(){document.getElementById("photodiode-spot").setAttribute("style","background-color: black"),t()},e)}(t,function(){setTimeout(function(){e(t,n-1)},t)})}(40,t),a&&a.send("trigger",e)}}},17:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"<div class=".concat(n?"center_container":t?"main-prompt":"main",">").concat(e,"</div>")}},19:function(e,t){e.exports={eventCodes:{test_connect:32,open_task:12,left:1,right:2,up:3,down:4,center:5,yawn:{start:6,stop:7},events:{start:8,stop:9},rest:{start:10,stop:11}}}},20:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"e",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return s});var o=n(15),r=function(e){document.getElementById(e).classList.add("nocursor")},a=function(e){return new Promise(function(t){return setTimeout(t,e)})},i=function(){var e=o.jsPsych.turk.turkInfo();return"".concat(e.workerId,":").concat(e.assignmentId)},c=function(){return function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var o=t[n].split("=");if(decodeURIComponent(o[0])===e)return decodeURIComponent(o[1])}}("PROLIFIC_PID")},s=function(e){var t=new AudioContext,n=t.createOscillator(),o=t.createGain();n.type=e.type,n.connect(o),n.frequency.setValueAtTime(e.frequency,0),console.log(t.currentTime),o.connect(t.destination),n.start(),n.stop(t.currentTime+.4)}},34:function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return h}),n.d(t,"a",function(){return f});var o=n(12),r=n.n(o),a=n(41),i=n(16),c=n(4),s=n(14),u=n(17),d=n(15),p=!1;if(c.b.USE_ELECTRON){var l=window.require("electron");p=l.ipcRenderer}var h=function(){document.title=c.e;var t='\n  <div class="d-flex flex-column align-items-center">\n  <p>'.concat(c.d.instructions.camera,'</p>\n  <video id="camera" width="640" height="480" autoplay></video>\n  </div>\n  ');return{type:"html_button_response",stimulus:Object(u.a)(t,!0)+Object(s.b)(),choices:[c.d.prompt.continue.button],response_ends_trial:!0,on_load:function(){var t=d.jsPsych.data.get().values()[0].participant_id,n=document.getElementById("camera"),o=function(o,r){console.log(o),"cameraCapture"===r&&(n.srcObject=o);var a=[];window[r]=new MediaRecorder(o,{mimeType:"video/webm"}),window[r].addEventListener("dataavailable",function(e){e.data.size>0&&a.push(e.data)}),window[r].addEventListener("stop",function(){!function(t,n,o){var r=new FileReader,a="pid_".concat(o,"_").concat(n,"_").concat(Date.now(),".webm");r.onload=function(){if(2===r.readyState){var n=new e(r.result);p.send("save_video",a,n),console.log("Saving ".concat(JSON.stringify({fileName:a,size:t.size})))}},r.readAsArrayBuffer(t)}(new Blob(a),r,t)})};navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){return o(e,"cameraCapture")}),window.require("electron").desktopCapturer.getSources({types:["window"]}).then(function(){var e=Object(i.a)(r.a.mark(function e(t){var n,i,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(a.a)(t);try{for(n.s();!(i=n.n()).done;)(s=i.value).name===c.e&&navigator.mediaDevices.getUserMedia({video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s.id}}}).then(function(e){o(e,"screenCapture")}).catch(function(e){return console.log(e)})}catch(r){n.e(r)}finally{n.f()}case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},on_finish:function(){if(c.b.USE_CAMERA)try{window.cameraCapture.start(),window.screenCapture.start()}catch(e){window.alert("Camera permissions were not given, if you choose to proceed, your recording will not be saved. Please restart the experiment after you have given permission.")}}}},f=function(e){return{type:"html_keyboard_response",stimulus:Object(u.a)("<h1>".concat(c.d.task.recording_end,"</h1>"),!0)+Object(s.b)(),trial_duration:e,on_load:function(){if(c.b.USE_CAMERA){console.log("finished");try{window.cameraCapture.stop(),window.screenCapture.stop()}catch(e){window.alert("Your video recording was not saved")}}}}}}).call(this,n(69).Buffer)},4:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"d",function(){return b}),n.d(t,"b",function(){return w}),n.d(t,"a",function(){return u});var o=n(15),r=n(21),a=n.n(r),i=n(19);n.d(t,"c",function(){return i.eventCodes});var c=n(25),s=n(20),u={frequency:100*(i.eventCodes.open_task-9),type:"sine"},d="Movement",p=!o.jsPsych.turk.turkInfo().outsideTurk,l=Object(s.b)()&&!p,h=!0,f="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_FIREBASE;try{window.require("electron")}catch(O){h=!1}var E="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_VIDEO&&h,_=h,m=h,b=n(67);if(!h){var v=n(68);a.a.merge(b,v)}var w=Object(c.init)({USE_PHOTODIODE:m,USE_EEG:_,USE_ELECTRON:h,USE_MTURK:p,USE_VOLUME:!0,USE_CAMERA:E,USE_PROLIFIC:l,USE_FIREBASE:f})},42:function(e){e.exports={a:"1.3.0"}},44:function(e,t,n){e.exports=n(81)},49:function(e,t,n){},51:function(e,t,n){},67:function(e){e.exports={task:{name:"Movement Task",end:"This experiment has ended.",recording_end:"Your recording has ended."},prompt:{continue:{press:"Press any key to continue.",button:"Continue"},focus:"Make sure the photodiode is covering the spot and any external recordings have begun before continuing.",fullscreen:"Press 'cmd + ctrl + F' to toggle Fullscreen.",zoom:"Zoom in to enlarge the screen.",setting_up:"Setting up task..."},welcome:{large_window:"Please make this window as large as possible.",message:"Instructions"},eventMarker:{found:"Note: event marker found.",not_found:"Note: no event marker found."},countdown:{message1:"Countdown for the first block",message2:"Countdown for the second block"},instructions:{moving_dot:"Try to relax and follow the dot on the screen as it moves by moving your head . Try to relax your shoulders, don't clench your jaw, and try not to move. Movements affect the quality of the EEG recordings.",yawn:'For this next section, start yawning when you hear a "beep", and stop when you hear another "beep".',events:['For this next section, tap the INS when you hear a "beep", and stop when you hear another "beep". ','For this next section, tap the lead extension when you hear a "beep", and stop when you hear another "beep". ','For this next section, take a few deep breaths when you hear a "beep", and stop when you hear another "beep". ','For this next section, start chewing when you hear a "beep", and stop when you hear another "beep". ','For this next section, cough a few times when you hear a "beep", and stop when you hear another "beep". ','For this next section, swallow a few times when you hear a "beep", and stop when you hear another "beep". ','For this next section, clench your jaw a few times when you hear a "beep", and stop when you hear another "beep". ','For this next section, twist your body left then right a few times when you hear a "beep", and stop when you hear another "beep". ','For this next section, raise and lower your left arm to the side 3 times when you hear a "beep", and stop when you hear another "beep". ','For this next section, raise and lower your right arm to the side 3 times when you hear a "beep", and stop when you hear another "beep". ','For this next section, tap your foot when you hear a "beep", and stop when you hear another "beep". '],fixate:"For the remaining minute and a half, fixate on the dot in the middle of the screen and try to relax.",align_photodiode:"Make sure the photodiode is aligned and the EEG recording has begun before continuing.",adjust_volume:"Set tablet volume to 50/100.",camera:"Make sure the camera is pointing to you and your face is within the camera area."},yawn:"Yawn.",events:["Tap the INS.","Tap the lead extension.","Take a few deep breaths","Start chewing.","Cough a few times.","Swallow a few times.","Clench your jaw a few times.","Twist your body left then right a few times.","Raise and lower your left arm to the side 3 times.","Raise and lower your right arm to the side 3 times.","Tap your foot."]}},68:function(e){e.exports={welcome:{message:"Welcome to the NEURO experiment."},userid:{set:"Setting up user ID."}}},81:function(e,t,n){"use strict";n.r(t);var o=n(2),r=n.n(o),a=n(40),i=n.n(a),c=(n(49),n(12)),s=n.n(c),u=n(16),d=n(18),p=(n(51),n(52),n(53),n(23)),l=n(43);var h=function(e){var t=e.onLogin,n=e.envParticipantId,a=e.envStudyId,i=e.validationFunction,c=Object(o.useState)(""),s=Object(d.a)(c,2),u=s[0],h=s[1],f=Object(o.useState)(""),E=Object(d.a)(f,2),_=E[0],m=E[1],b=Object(o.useState)(!1),v=Object(d.a)(b,2),w=v[0],O=v[1];return Object(o.useEffect)(function(){h(n),m(a)},[n,a]),r.a.createElement("div",{className:"centered-h-v"},r.a.createElement("div",{className:"width-50"},w?r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"The participant ID and study ID do not match"):null,r.a.createElement(p.a,{className:"centered-h-v",onSubmit:function(e){e.preventDefault(),i(u,_).then(function(e){e?t(e,_,u):O(!0)})}},r.a.createElement(p.a.Group,{className:"width-100",size:"lg",controlId:"participantId"},r.a.createElement(p.a.Label,null,"Participant ID"),r.a.createElement(p.a.Control,{autoFocus:!0,type:"participantId",value:u,onChange:function(e){return h(e.target.value)}})),r.a.createElement(p.a.Group,{className:"width-100",size:"lg",controlId:"studyId"},r.a.createElement(p.a.Label,null,"Study ID"),r.a.createElement(p.a.Control,{type:"studyId",value:_,onChange:function(e){return m(e.target.value)}})),r.a.createElement(l.a,{style:{width:"100%"},block:!0,size:"lg",type:"submit",disabled:!(u.length>0&&_.length>0)},"Log In"))))},f=n(15),E=n(4),m=n(14),b=n(17),v=function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",'<span style="color: green;">'.concat(E.d.eventMarker.found,"</span>"));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),w=function(){return{type:"html_button_response",stimulus:Object(b.a)("<div><h2 id='usb-alert'></h2></div>",!0)+Object(m.b)(),prompt:["<br><h3>".concat(E.d.prompt.focus,"</h3>")],choices:[E.d.prompt.continue.button],on_load:function(){return v().then(function(e){return document.getElementById("usb-alert").innerHTML=e})}}},O=n(20),y=function(){return{type:"html_keyboard_response",stimulus:Object(b.a)("<h1>".concat(E.d.prompt.setting_up,"</h1>"),!0)+Object(m.b)(),trial_duration:2e3,on_load:function(){Object(m.a)(E.c.open_task),Object(O.a)(E.a)}}},g=function(){return{type:"html_keyboard_response",stimulus:Object(b.a)("\n    <div class='instructions'>\n    <h1>".concat(E.d.instructions.adjust_volume,"</h1>\n    </div>\n    "),!0),prompt:E.d.prompt.continue.press,response_ends_trial:!0}},P=n(25),A=[Object(P.showMessage)(E.b,{responseType:"html_button_response",message:E.d.task.name,responseEndsTrial:!0,buttons:[E.d.prompt.continue.button]})];E.b.USE_VOLUME&&A.push(g()),E.b.USE_PHOTODIODE&&(A.push(w()),A.push(y()));for(var U={type:"html_keyboard_response",stimulus:"",timeline:A},C=(n(21),function(e){document.getElementById("fixation-container").setAttribute("class","move-".concat(e))}),S=function(){var e=new AudioContext,t=e.createOscillator(),n=e.createGain();t.type="sine",t.connect(n),n.connect(e.destination),t.start(),n.gain.exponentialRampToValueAtTime(1e-7,e.currentTime+1)},T=function(e){return new Promise(function(t){return setTimeout(t,e)})},j=n(19),I=function(){var e=Object(u.a)(s.a.mark(function e(t,n,o,r,a){var i,c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(){return Date.now()-o},c=r[n],e.next=4,T(t);case 4:C(n),Object(m.a)(c),a.push({code:c,rt:i(),timestamp:Date.now()});case 7:case"end":return e.stop()}},e)}));return function(t,n,o,r,a){return e.apply(this,arguments)}}(),R=function(e){var t='<div id="fixation-container"><div id="fixation-dot"> </div></div>'+Object(m.b)(),n=function(){var e=Object(u.a)(s.a.mark(function e(t,n,o,r){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"left"===t&&(n.push({code:r.center,rt:0,timestamp:Date.now()}),Object(m.a)(r.center)),e.next=3,I(5e3,t,o,r,n);case 3:return e.next=5,I(2e3,"center",o,r,n);case 5:return e.next=7,I(2e3,t,o,r,n);case 7:return e.next=9,I(2e3,"center",o,r,n);case 9:return e.next=11,I(2e3,t,o,r,n);case 11:return e.next=13,I(2e3,"center",o,r,n);case 13:console.log(n);case 14:case"end":return e.stop()}},e)}));return function(t,n,o,r){return e.apply(this,arguments)}}();return{type:"call_function",async:!0,func:function(o){Object(O.d)("experiment");var r=Date.now(),a=[];document.getElementById("jspsych-content").innerHTML=t;var i=document.getElementsByClassName("jspsych-content-wrapper")[0];i.setAttribute("class","fixation-container"),n(e,a,r,j.eventCodes),setTimeout(function(){return o({direction:e,code:j.eventCodes[e],start:r,data:a})},"down"===e?17e3:15100),i.setAttribute("class","jspsych-content-wrapper")}}},k=function(e,t){var n='<div id="dot-container"><h3>'.concat(E.d[e],"</h3></div>")+Object(m.b)();return t>=0&&(n='<div id="dot-container"><h3>'.concat(E.d[e][t],"</h3></div>")+Object(m.b)()),{type:"html_keyboard_response",choices:f.jsPsych.NO_KEYS,stimulus:n,trial_duration:11e3,on_load:function(){var t=Object(u.a)(s.a.mark(function t(){var n,o,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Date.now(),o=j.eventCodes[e],r=[],Object(m.a)(o.start),S(),r.push({trial:e,code:o.start,rt:Date.now()-n}),t.next=8,T(1e4);case 8:Object(m.a)(o.stop),S(),r.push({trial:e,code:o.stop,rt:Date.now()-n}),f.jsPsych.data.write(r);case 12:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}},D=function(e){return{type:"html_keyboard_response",stimulus:Object(b.a)("\n    <div class='instructions'>\n    <h1>".concat(e,"</h1>\n    </div>\n    "),!0),prompt:E.d.prompt.continue.press,response_ends_trial:!0}},x=n(34),L=[U,{type:"html_keyboard_response",stimulus:Object(b.a)("\n  <div class='instructions'>\n  <h1>".concat(E.d.instructions.moving_dot,"</h1>\n  </div>\n  "),!0),prompt:E.d.prompt.continue.press,response_ends_trial:!0},R("left"),R("right"),R("up"),R("down"),D(E.d.instructions.yawn),k("yawn"),D(E.d.instructions.yawn),k("yawn")],N=0;N<E.d.instructions.events.length;N++)L.push(D(E.d.instructions.events[N])),L.push(k("events",N));E.b.USE_CAMERA&&(L.splice(1,0,Object(x.b)()),L.push(Object(x.a)(5e3))),L.push(Object(P.showMessage)(E.b,{duration:5e3,message:E.d.task.end}));var M=[U],F=E.b.USE_MTURK?M:L;var V=function(e){var t=e.dataUpdateFunction,n=e.dataFinishFunction;return r.a.createElement("div",{className:"App"},r.a.createElement(f.Experiment,{settings:{timeline:F,on_data_update:function(e){return t(e)},on_finish:function(e){return n(e)}}}))},B=n(30);n(77);n(78).config();var G={apiKey:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_apiKey,authDomain:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_authDomain,databaseURL:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_databaseURL,projectId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_projectId||"no-firebase",storageBucket:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_storageBucket,messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_messagingSenderId,appId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_USE_PHOTODIODE:"true",REACT_APP_USE_EEG:"true",REACT_APP_VOLUME:"true"}).REACT_APP_appId},H=B.a.initializeApp(G).firestore();"localhost"===window.location.hostname&&H.useEmulator("localhost",8080);var q=function(e,t,n){return H.collection("participant_responses").doc(t).collection("participants").doc(e).collection("data").doc(n).set({start_time:n,app_version:window.navigator.appVersion,app_platform:window.navigator.platform,results:[]}).then(function(){return!0}).catch(function(e){return!1})},z=function(e){console.log(e);var t=e.participant_id,n=e.study_id,o=e.start_date;H.collection("participant_responses").doc(n).collection("participants").doc(t).collection("data").doc(o).update("results",B.a.firestore.FieldValue.arrayUnion(e))},K=(B.a,n(42));var Y=function(){var e=(new Date).toISOString(),t=Object(o.useState)(!1),n=Object(d.a)(t,2),a=n[0],i=n[1],c=Object(o.useState)(!1),p=Object(d.a)(c,2),l=p[0],m=p[1],b=Object(o.useState)(!1),v=Object(d.a)(b,2),w=v[0],y=v[1],g=Object(o.useState)(""),P=Object(d.a)(g,2),A=P[0],U=P[1],C=Object(o.useState)(""),S=Object(d.a)(C,2),T=S[0],j=S[1],I=Object(o.useState)("default"),R=Object(d.a)(I,2),k=R[0],D=R[1],x=Object(o.useState)(!1),L=Object(d.a)(x,2),N=L[0],M=L[1],F=new URLSearchParams(window.location.search),B=function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),G=function(e){},H=Object(o.useCallback)(function(t,n,o){t&&f.jsPsych.data.addProperties({participant_id:o,study_id:n,start_date:e,task_version:K.a}),i(t)},[e]);return Object(o.useEffect)(function(){if(console.log("Turk:",E.b.USE_MTURK),console.log("Firebase:",E.b.USE_FIREBASE),console.log("Prolific:",E.b.USE_PROLIFIC),console.log("Electron:",E.b.USE_ELECTRON),console.log("Video:",E.b.USE_CAMERA),console.log("Volume:",E.b.USE_VOLUME),console.log("Event Marker:",E.b.USE_EEG),console.log("Photodiode:",E.b.USE_PHOTODIODE),E.b.USE_ELECTRON){var e=window.require("electron").ipcRenderer;m(e),e.send("updateEnvironmentVariables",E.b);var t=e.sendSync("syncCredentials");t.envParticipantId&&U(t.envParticipantId),t.envStudyId&&j(t.envStudyId),D("desktop")}else if(E.b.USE_MTURK){window.lodash=_.noConflict();var n=Object(O.c)();y(new PsiTurk(n,"/complete")),D("mturk"),H(!0,"mturk",n)}else if(E.b.USE_PROLIFIC){var o=Object(O.b)();E.b.USE_FIREBASE&&o?(D("firebase"),H(!0,"prolific",o)):M(!0)}else if(E.b.USE_FIREBASE){D("firebase");var r=F.get("participantID"),a=F.get("studyID");r&&U(r),a&&j(a)}else M(!0)},[]),N?r.a.createElement("div",{className:"centered-h-v"},r.a.createElement("div",{className:"width-50 alert alert-danger"},"Please ask your task provider to enable firebase.")):r.a.createElement(r.a.Fragment,null,a?r.a.createElement(V,{dataUpdateFunction:{desktop:function(e){l.send("data",e)},firebase:function(e){z(e)},mturk:function(e){w.recordTrialData(e)},default:G}[k],dataFinishFunction:{desktop:function(){l.send("end","true")},mturk:function(){!function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return w.saveData(),e.next=3,Object(O.e)(5e3);case 3:w.completeHIT();case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},firebase:G,default:G}[k]}):r.a.createElement(h,{validationFunction:{desktop:B,default:B,firebase:function(t,n){return q(t,n,e)}}[k],envParticipantId:A,envStudyId:T,onLogin:H}))};i.a.render(r.a.createElement(Y,null),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.8ab66d21.chunk.js.map